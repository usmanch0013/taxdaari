(function($){"use strict";var widgetInstagramLocation=window.widgetInstagramLocation=function($scope){function publishDataLocation(a){$targetLoader.add($targetLoaderNext).hide();var b=!!$targetCheckBox1.is(":checked"),c=!!$targetCheckBox2.is(":checked");if(a.headError)return $targetError.html("<span>"+a.headError+"</span>"),!1;if(!a.medias)return $targetError.html("<span>Nothing to display</span>"),!1;var d="location_"+$targetSelectedItem.val().replace(/\s+/g,"").toLocaleLowerCase()+".json";if(sessionStorage&&!sessionStorage.getItem(d))try{sessionStorage.setItem(d,JSON.stringify(a))}catch(a){console.log("EAC sessionStorage: d\xE9passement de quota!")}var e=!1==b?a.medias:a.mediasTop,f=a.profile;if(!0===c){if(a.jqcloud){var g=$targetJqCloud.parent().width();$targetJqCloudPara.show(),$targetJqCloud.css({width:g,height:g/2}),$targetJqCloud.jQCloud(a.jqcloud,{autoResize:!0,colors:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#c7cf00","#a65628","#f781bf","#999999"],fontSize:{from:.05,to:.01}})}else $targetError.html("<span>Nothing to display</span>");return!1}f.has_next_page&&f.end_cursor?(instanceAjax.setNextPage(f.id,f.end_cursor),!b&&$targetButtonNext.show()):(instanceAjax.resetNextPage(),$targetButtonNext.hide()),isNextPage||publishHeaderLocation(f),publishContentLocation(e,f)}function publishHeaderLocation(a){var b=!!$targetCheckBox1.is(":checked"),c="<div class=\"insta-location__header-img\"><a href=\"https://www.instagram.com/explore/locations/"+a.id+"\" target=\"_blank\" rel=\"nofollow\"><img class=\"eac-image-loaded\" src=\""+a.headLogo+"\" alt=\""+a.headTitle+"\"></a></div>";$targetHeader.append(c);var d=$("<div/>",{class:"insta-location__header-content"});d.append("<div><a href=\"https://www.instagram.com/explore/locations/"+a.id+"\" target=\"_blank\" rel=\"nofollow\"><h3>"+a.headTitle.substring(0,27)+"...</h3></a></div>"),!1==b?(d.append("<div><span class=\"insta-location__header-info\"><i class=\"fas fa-camera\" aria-hidden=\"true\"></i>"+a.headTotalCount+"</span><span class=\"insta-location__header-info\"><i class=\"far fa-heart\" aria-hidden=\"true\"></i>"+a.headTotalLikes+"</span><span class=\"insta-location__header-info\"><i class=\"far fa-comment\" aria-hidden=\"true\"></i>"+a.headTotalComments+"</span><span class=\"insta-location__header-info\"><i class=\"fa fa-film\" aria-hidden=\"true\"></i>"+a.headTotalVideos+"</span><span class=\"insta-location__header-info\"><i class=\"fa fa-hashtag\" aria-hidden=\"true\"></i>"+a.headTotalHashtags+"</span></div>"),d.append("<div><span class=\"insta-location__header-info\">"+a.headDateDiff+"</span></div>")):d.append("<div><span class=\"insta-location__header-info\"><i class=\"fas fa-camera\" aria-hidden=\"true\"></i>"+a.headTotalCountTop+"</span><span class=\"insta-location__header-info\"><i class=\"far fa-heart\" aria-hidden=\"true\"></i>"+a.headTotalLikesTop+"</span><span class=\"insta-location__header-info\"><i class=\"far fa-comment\" aria-hidden=\"true\"></i>"+a.headTotalCommentsTop+"</span><span class=\"insta-location__header-info\"><i class=\"fa fa-film\" aria-hidden=\"true\"></i>"+a.headTotalVideosTop+"</span><span class=\"insta-location__header-info\"><i class=\"fa fa-hashtag\" aria-hidden=\"true\"></i>"+a.headTotalHashtagsTop+"</span></div>"),a.website&&d.append("<span class=\"insta-location__header-info\"><i class=\"fas fa-globe-europe\" aria-hidden=\"true\"></i><a href=\""+a.website+"\" target=\"_blank\" rel=\"nofollow\"><span>Web site</span></a></span>"),$targetHeader.append(d)}function publishContentLocation(Items,Profile){if(Items.sort(sort_by(settings.data_sort,!0,parseInt)),Profile.lat&&Profile.lng){"undefined"!=typeof osmMap&&osmMap.remove(),$targetMap.css("height","250px");var dataMap={};dataMap.mapDiv=$targetMap.attr("id"),dataMap.lat=Profile.lat,dataMap.lng=Profile.lng,dataMap.popupContent=""===Profile.nominatim?Profile.headTitle:Profile.nominatim,JSON.stringify(dataMap),osmMap=showOsmMap(dataMap)}$target.isotope(isotopeOptions),$.each(Items,function(indice,item){var $wrapperItem=$("<div/>",{class:"insta-location__item"}),$wrapperContent=$("<div/>",{class:"insta-location__item-content "+settings.data_style}),$wrapperIcones=$("<div/>",{class:"insta-location__meta-items"}),$wrapperHeadIcones=$("<div/>",{class:"insta-location__head-icon"});if(item.username){var pubpic="<div class=\"insta-location__username-picture\"><a href=\"https://www.instagram.com/"+item.username+"\" target=\"_blank\" rel=\"nofollow\"><img class=\"eac-image-loaded\" src=\""+item.username_pic+"\" alt=\""+item.username+"\" title=\""+item.username+"\"/></a></div>";$wrapperHeadIcones.append(pubpic)}if(settings.data_video,settings.data_link&&(settings.data_video||item.username)){var instaLink="https://www.instagram.com/p/"+item.linkNode+"/",readMore="<div class=\"insta-location__meta-item insta-location__link\"><span class=\"insta-location__link-icon\"><a href=\""+instaLink+"\" target=\"_blank\" rel=\"nofollow\"><i class=\"fa fa-instagram fa-lg\" aria-hidden=\"true\"></i></a></span></div>";$wrapperHeadIcones.append(readMore)}0!==$wrapperHeadIcones.html().length&&$wrapperContent.append($wrapperHeadIcones);var img="",imgsrcset="srcset=\""+item.img_thumb+" 150w,"+item.image240px+" 240w,"+item.img_low+" 320w,"+item.image480px+" 480w,"+item.img_med+" 640w\" sizes=\"293px\"",imageLayout=eval("item."+settings.data_photo_size);if(settings.data_lightbox){var dataCaption=item.caption?item.caption.replace(/"/g,"'").substring(0,100)+"...":"...";dataCaption=null===item.username?dataCaption:item.username+"::"+dataCaption,img="<div class=\"insta-location__item-image\"><a href=\""+eval("item."+settings.data_photo_size)+"\" data-elementor-open-lightbox=\"no\" data-fancybox=\"insta-location-gallery\" data-caption=\""+dataCaption+"\"><img class=\"eac-image-loaded\" src=\""+imageLayout+"\" alt=\"Hooops!!!\"></a></div>"}else if(!settings.data_link){var dataLink="https://www.instagram.com/p/"+item.linkNode+"/";img="<div class=\"insta-location__item-image\"><a href=\""+dataLink+"\" target=\"_blank\" rel=\"nofollow\"><img class=\"eac-image-loaded\" src=\""+imageLayout+"\" alt=\"Hooops!!!\"></a></div>"}else img="<div class=\"insta-location__item-image\"><img class=\"eac-image-loaded\" src=\""+imageLayout+"\" alt=\"Hooops!!!\"></div>";if($wrapperContent.append(img),settings.data_likes&&0<parseInt(item.likeCount)){var likes="<div class=\"insta-location__meta-item insta-location__likes-count\" data-likes=\""+item.linkNode+"\"><span class=\"insta-location__likes-icon\"><i class=\"far fa-heart\" aria-hidden=\"true\"></i><span>"+item.likeCount+"</span></span></div>";$wrapperIcones.append(likes)}if(settings.data_comments&&0<parseInt(item.commentCount)){var comments="<div class=\"insta-location__meta-item insta-location__comments-count\" data-comments=\""+item.linkNode+"\"><span class=\"insta-location__comments-icon\"><i class=\"far fa-comment\" aria-hidden=\"true\"></i><span>"+item.commentCount+"</span></span></div>";$wrapperIcones.append(comments)}if(settings.data_hashtag&&0<parseInt(item.hashtagCount)){var hashtag="<div class=\"insta-location__meta-item insta-location__hashtags-count\" data-hashtags=\""+item.hashtagList+"\"><span class=\"insta-location__hashtags-icon\" title=\"Show hashtags\"><i class=\"fa fa-hashtag\" aria-hidden=\"true\"></i><span>"+item.hashtagCount+"</span></span></div>";$wrapperIcones.append(hashtag)}if(settings.data_date){var update="<div class=\"insta-location__meta-item insta-location__published\"><span>"+item.updateEnJours+"</span></div>";$wrapperIcones.append(update)}if(settings.data_link&&!settings.data_video&&!item.username){var instaLinkVid="https://www.instagram.com/p/"+item.linkNode+"/",readMoreVid="<div class=\"insta-location__meta-item insta-location__link\"><span class=\"insta-location__link-icon\"><a href=\""+instaLinkVid+"\" target=\"_blank\" rel=\"nofollow\"><i class=\"fa fa-instagram fa-lg\" aria-hidden=\"true\"></i></a></span></div>";$wrapperIcones.append(readMoreVid)}if(0!==$wrapperIcones.html().length&&$wrapperContent.append($wrapperIcones),settings.data_caption){""!==item.caption&&(item.caption=removeEmojis(item.caption),item.caption=item.caption.substring(0,settings.data_length)+"[...]");var caption="<div class=\"insta-location__item-description\"><p>"+item.caption+"</p></div>";$wrapperContent.append(caption)}$wrapperItem.append($wrapperContent),$target.append($wrapperItem).isotope("appended",$wrapperItem)}),$target.imagesLoaded(function(){$target.isotope("layout")});var valueButton=parseInt($targetItemsCount.text())+parseInt(Items.length);$targetItemsCount.text(" "+valueButton),isotopeActive=!isotopeActive}var osmMap,$targetInstance=$scope.find(".eac-insta-location"),$target=$scope.find(".insta-location"),$targetSelect=$scope.find("#insta-location__options-items"),$targetSelectedItem=$scope.find("#insta-location__item-name"),$targetCheckBox1=$scope.find("#insta-location__items-cb"),$targetCheckBox2=$scope.find("#insta-location__items-cb2"),$targetButton=$scope.find("#insta-location__read-button"),$targetHeader=$scope.find(".insta-location__header"),$targetError=$scope.find(".insta-location__error"),$targetLoader=$scope.find("#insta-location__loader-wheel"),$targetButtonNext=$scope.find("#insta-location__read-button-next"),$targetLoaderNext=$scope.find("#insta-location__loader-wheel-next"),$targetItemsCount=$scope.find(".insta-location__read-button-next-paged"),isNextPage=!1,$targetJqCloud=$scope.find(".insta-location__jqcloud"),$targetJqCloudSpan=$scope.find(".insta-location__jqcloud span"),$targetJqCloudPara=$scope.find(".insta-location__container-jqcloud p"),$targetContainerHiddenContent=$scope.find(".insta-location__container-hidden-content"),$targetHiddenContent=$targetContainerHiddenContent.find(".insta-location__hidden-content"),$targetMentionPara=$targetContainerHiddenContent.find(".insta-location__hd-mention"),$targetLikesPara=$targetContainerHiddenContent.find(".insta-location__hd-likes"),$targetCommentsPara=$targetContainerHiddenContent.find(".insta-location__hd-comments"),$targetContainerMap=$scope.find(".insta-location__container-map"),$targetMap=$scope.find(".insta-location__map"),settings=$target.data("settings")||{},instanceAjax={},instagram_uriLocation="https://www.instagram.com/explore/locations/",instagram_uriShortcode="https://www.instagram.com/p/",instagram_uriUser="https://www.instagram.com/",instagram_uriExplore="https://www.instagram.com/explore/tags/",proxy_location="proxy_location.php",proxy_shortcode="proxy_shortcode.php",ajaxOptionsUrlVideo="locationShortcodePage",prefixCache="location_",postfixCache=".json",graphSidecar="GraphSidecar",locationCookie="eac-lselect#",isotopeActive=!1,isotopeOptions={itemSelector:".insta-location__item",percentPosition:!0,masonry:{columnWidth:".insta-location__item-sizer",horizontalOrder:!0},layoutMode:settings.data_layout,sortBy:"original-order",visibleStyle:{transform:"scale(1)",opacity:1},hiddenStyle:{transform:"scale(0.001)",opacity:0}};settings.data_length&&(instanceAjax=new ajaxCallFeed,setSelectOptionsCookies("eac-lselect#",$targetSelect),$targetSelect.find("option:first").attr("selected","selected"),$targetSelectedItem.val($targetSelect.eq(0).val()),$targetSelect.on("change",function(a){a.preventDefault(),$targetSelectedItem.val($(this).val()),$(".insta-location__item",$target).remove(),$targetJqCloud.empty().css({width:0,height:0}).jQCloud("destroy"),$targetJqCloudPara.add($targetButtonNext).hide(),$targetCheckBox1.add($targetCheckBox2).prop("checked",!1),$targetHeader.add($targetHiddenContent).add($targetError).html(""),$targetContainerHiddenContent.removeClass("fancybox-content").removeAttr("style"),$targetMap.html("").css("height",""),isotopeActive&&($target.isotope("destroy"),isotopeActive=!isotopeActive),$target.css("height",""),instanceAjax.resetNextPage(),isNextPage=!1,$targetItemsCount.text("0")}),$targetCheckBox1.add($targetCheckBox2).on("click",function(){$(".insta-location__item",$target).remove(),$targetJqCloud.empty().css({width:0,height:0}).jQCloud("destroy"),$targetJqCloudPara.add($targetButtonNext).hide(),$targetHeader.add($targetHiddenContent).add($targetError).html(""),$targetContainerHiddenContent.removeClass("fancybox-content").removeAttr("style"),isotopeActive&&($target.isotope("destroy"),isotopeActive=!isotopeActive),$target.css("height",""),instanceAjax.resetNextPage(),isNextPage=!1,$targetItemsCount.text("0")}),$targetCheckBox1.on("click",function(){$targetCheckBox2.prop("checked",!1)}),$targetCheckBox2.on("click",function(){$targetCheckBox1.prop("checked",!1)}),$targetSelectedItem.on("keyup",function(a){13===a.which&&(a.preventDefault(),$targetSelectedItem.blur(),$targetButton.click())}),$targetButton.on("click touch",function(a){if(a.preventDefault(),$(".insta-location__item",$target).remove(),$targetJqCloud.empty().css({width:0,height:0}).jQCloud("destroy"),$targetJqCloudPara.add($targetButtonNext).hide(),$targetHeader.add($targetHiddenContent).add($targetError).html(""),$targetContainerHiddenContent.removeClass("fancybox-content").removeAttr("style"),$targetMap.html("").css("height",""),isotopeActive&&($target.isotope("destroy"),isotopeActive=!isotopeActive),0!==$targetSelectedItem.val().length){var b=$targetSelectedItem.val().replace(/\s+/g,"").toLocaleLowerCase(),c="location_"+b+".json";$targetLoader.show();var d=!!(sessionStorage&&sessionStorage.getItem(c))&&sessionStorage.getItem(c);d?(isNextPage=!1,$targetItemsCount.text("0"),publishDataLocation(JSON.parse(d))):instanceAjax.init("","proxy_location.php","",b)}}),$targetButtonNext.on("click touch",function(a){a.preventDefault(),$targetError.html("");var b=$targetSelectedItem.val().replace(/\s+/g,"").toLocaleLowerCase();isNextPage=!0,$targetLoaderNext.show(),$targetButtonNext.hide(),instanceAjax.init("","proxy_location.php","",b)}),$targetInstance.on("click touch",".insta-location__jqcloud span",function(a){a.preventDefault();var b=$(this).text().substring(1,9999).trim(),c=b.replace(/[\.,;:\'\"\*\(\)]/g," ").toLocaleLowerCase(),d="eac-lselect#"+c;if(navigator.cookieEnabled)if(-1===document.cookie.indexOf(d))document.cookie=d+"="+b+" ;max-age=2462435;sameSite=strict",$targetSelectedItem.val(b),$targetSelect.append("<option value=\""+b+"\" selected=\"selected\">"+c+"</option>");else return;$(".insta-location__item",$target).remove(),$targetJqCloud.empty().css({width:0,height:0}).jQCloud("destroy"),$targetJqCloudPara.hide(),$targetHeader.add($targetHiddenContent).add($targetError).html(""),$targetContainerHiddenContent.removeClass("fancybox-content").removeAttr("style"),$targetCheckBox1.add($targetCheckBox2).prop("checked",!1),isotopeActive&&($target.isotope("destroy"),isotopeActive=!isotopeActive)}),$targetInstance.on("click touch",".insta-location__meta-item.insta-location__hashtags-count",function(){var a=$(this).attr("data-hashtags").split(",");if(0<a.length){var b=$.map(a,function(a){return"<div><a href=\"https://www.instagram.com/explore/tags/"+a.substring(1,9999)+"/\" target=\"_blank\" rel=\"nofollow\">"+a+"</a></div>"});$targetHiddenContent.css("flex-direction","column"),$targetHiddenContent.html(b),$targetContainerHiddenContent.removeClass("fancybox-content").removeAttr("style"),$targetLikesPara.add($targetCommentsPara).hide(),$targetMentionPara.show(),$.fancybox.open([{src:$targetContainerHiddenContent,type:"inline",opts:{smallBtn:!0,buttons:[""],afterClose:function(){$targetHiddenContent.html("")}}}])}return!1}),$targetInstance.on("click touch",".insta-location__download-video",function(a){a.preventDefault();var b=$(this).attr("data-shortcode"),c=$targetSelectedItem.val().replace(/\s+/g,"").toLocaleLowerCase();0<b.length&&instanceAjax.init("","proxy_shortcode.php","locationShortcodePage",b,"",c)}),$targetSelectedItem.on("change",function(a){a.preventDefault(),$(".insta-location__item",$target).remove(),$targetJqCloud.empty().css({width:0,height:0}).jQCloud("destroy"),$targetJqCloudPara.add($targetButtonNext).hide(),$targetCheckBox1.add($targetCheckBox2).prop("checked",!1),$targetHeader.add($targetHiddenContent).add($targetError).html(""),$targetContainerHiddenContent.removeClass("fancybox-content").removeAttr("style"),$targetMap.html("").css("height",""),isotopeActive&&($target.isotope("destroy"),isotopeActive=!isotopeActive),$target.css("height",""),instanceAjax.resetNextPage(),isNextPage=!1,$targetItemsCount.text("0")}),$(document).ajaxComplete(function(a,b,c){if(c.ajaxOptions&&c.ajaxOptions===instanceAjax.getOptions()){a.stopImmediatePropagation();var d=instanceAjax.getItems();if(d.headError)return $targetLoader.add($targetLoaderNext).hide(),$targetError.html("<span>"+d.headError+"</span>"),!1;c.ajaxRequestedData&&c.ajaxRequestedData===instanceAjax.getRequestedData()?d.likesComments&&0<d.likesComments.length?(showLikesComments(d.likesComments,$targetHiddenContent,"https://www.instagram.com/"),$.fancybox.open([{src:$targetContainerHiddenContent,type:"inline",opts:{smallBtn:!0,buttons:[""],afterClose:function(){$targetHiddenContent.html("")}}}])):d.videoUrl&&d.videoUrl.url&&instanceAjax.callFetch(d.videoUrl.url):publishDataLocation(d)}}))}})(jQuery);